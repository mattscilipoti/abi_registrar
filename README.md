# ABI Registrar

Tools to support the Registrar position for Arden Beaches Inc. (ABI)
- Lots
  - Lot Fees
- Properties
- Residents
- Amenities
  - Vehicle/Trailer Passes
  - Watercraft Slot
- Shares

Not only do we need to gather and manage the approprite information, we need to make it available to people, where they need it. This includes printing reports for off-line use.
- Possible Report Options:
  - export to Google Sheet & printing from there.

## Features

### Done

  - Manage Lots
    - Record Lot fee payments (not connected to Quickbooks)
    - Search by Lot, Property, or Resident info
  - Manage Properties
    - Have one or more Lots
    - Identified by TaxID
    - Owned by one or more Residents
    - Can mark as membership_eligible?
    - Add date-stamped Comments
    - Search by Property, Lot, or Resident info
  - Manage Residents
    - Associated with one or more Properties
    - Deed Holders: Owner, Co-owner, Trustee
    - Non-deed Holders: Border, Dependent, Renter, Spouse
    - Can toggle verified from index table
    - Mark as verified
    - Search by Last Name, Property Address, or Lot info
    - Add date-stamped Comments
    - List residents w/o Resident Status (Deed Holder, etc.)
    - List residents w/o email
    - List residents w/o mailing address
    - Mailing Address
      - Select Primary Residence, default if only one
      - Mailing address defaults to Primary Residence address
      - Can assign Alternate Mailing Address
  - Manage Shares
    - Record Purchased Shares
      - Only Deed Holders
      - Each transation: Date purchased, count
      - Total count owned
      - Assign shares to Property
    - Transfer Shares
    - Can Edit/Delete via Item Tranaactions
  - Manage Vehicle Stickers
    - Assign Sticker and Vehicle to Resident
    - Search via Sticker Number, Tag Number, State, or Resident info
  - Manage Transactions
    - Search via by Type, Activity, Resident, Property
  - Search
    - Can search by "Problematic" or "Expects Payment"
    - Defaults to "Problematic"
  - Audit Transactions
    - ItemTransactions#show lists previous versions
  - Add Summary page (as Home page)
  - Configuration
    - Display DateTime in Eastern Time Zone
    - DateTimes shown in time_ago_in_words, tooltip is actual time
  - Security
    - Authentication, via password or email
    - List Application Administators
  - Import Lots, Properties, Residents
    - Source: "Arden Property Owners & NSB Properties": https://docs.google.com/spreadsheets/d/1a8-fnFI-7YImNmB9dSKZG4xj_stYDBkl/edit?usp=sharing&ouid=101094552356953280075&rtpof=true&sd=true
  - Import Shares
    - Note: transacted_at DateTime will update for ALL Imported Share Transactions on EACH Import (I think this is appropriate, if we are using the same spreadsheet).
    - Source: SharesRegistrarSpreadsheet: https://docs.google.com/spreadsheets/d/1F-FEmh14Go5bLmCDrcDax2tbJycWvHoz/edit?rtpof=true


### TODO
  - Meeting 2022/09/11
    - ~~Move TaxID to Property~~
    - Import from new spreadsheet
      - Code Complete, awaiting updated spreadsheet for testing
    - Property:
      - ~~Rename AbiMember -> MembershipEligible~~
      - Have partial lots (shared among multiple properties)
    - Resident
      -  Shareholder? (has 1 or more shares)
        - Remaining shares are automatically transferred to new owner on property transfer(unless transferred)
      - Deceased?
    - Summary page from Registrar Report
      - Over time?
    - Ownership verified (via SDAT) (Not the same as verified residency)
      - When transferring ownership, may not be verified for a while
      - Deed holder
    - Residency:
      - ~~Add ResidentType: Border, Trustee (Deed Holder), Spouse~~
    - Resident: add birth year for minors
      - Display Birth Year, Age
      - Is verified once we assign Resident Status
    - Lot: add Comments
    - Passes:
      - Rename: Vehicle Pass,
      - Add: Ramp Pass (Sticker, Tag, Vessel Registration Number), Dinghy Pass (), Watercraft Pass
  - ABI
    - Indicate non-Sunrise beach that have access (Not)
  - Audit Transactions
    - Undo lastest change
    - Revert to previous version
    - List deleted transactions
      - Restore  deleted transaction
  - Manage Property
    - Link to SDAT (cannot find direct link, can probably mechanize fill-in of search fields)
  - Manage Property Transfer
    - Inform ACA
    - Transfer Residency
      - Invalidate previous residents
      - (?) Validate new residents or assist validating new?
    - Transfer Shares
    - Support Onboarding
      - What steps occur for new Residents?
    - List past Owners
  - Manage Residents
    - Add Status of "Border"
  - Manage Members
    - All Residents w/Shares?
      - No
    - Who are eligable?
      - Deed holders of Properties identified as Sunrise Beach Subdivision (748)
  - Manage Beach Parties?
    - A: probably not. Registrar manages this outside of this app. Uses this app to verify Resident
    - Reservations
    - Sync to Invoices?
    - Vehicle Passes
  - Manage Beach Passes
    - Requested via Jotform
    - Verify
      - Verified Resident
      - Lot fees to be paid
    - (possible) Email Beach Passes to Deed Holders, with QR Code
  - Import Lots
    - Lot Fees Paid
    - Without a Lot Number (e.g. 1035 Miller)
  - Import Properties
    - Without a Street Number (Hampton Dr)
  - Import Residents
    - How to Handle 2 Properties on 1 Lot (e.g. 1007/1007A Dockser)?
    - Minor
    - Status (Deed Holder, etc.)
      - Owner, Co-owner, Dependent, Boarder, Renter
    - Verified
  - Sync Lot Fees with QuickBooks
  - Manage Administrators
  - Manage Donations
    - In QuickBooks?
  - Manage Watercraft Slots
    - Reports for Beach Checkers (Pass Number, Description of Watercraft[optional])
  - Manage Boat Ramp Stickers
    - Reports for Beach Checkers (Pass Number, Trailer Tag Number/Boat Registration Number)
    - Verify
      - Requires Vehicle
  - Manage Vehicle Stickers
    - Reports for Beach Checkers (Pass Number, Vehicle Tag Number, Make, Model)
  - Manage Beach Checkers?
    - Reports of work performed
    - Recording beach activity
    - Record incidents
  - Optimizations
    - Why some Versions.reify.nil?
  - Lots
    - Subdivide a lot
  - Resident
    - Mailing Address
      - Can select associated Property
    - Do we need age?
      - Only for vetting! Just store minor.
      - Possibly store: What year do they turn 21?
  - Email Blasts
     - Requirements
       - To all residents
       - To all holders of a specific pass type
       - To all share holders
     - Needs: email provider (e.g. SendGrid, MailChimp?) to manage email blacklists, etc.
       - Need ability to unsubscribe
       - Sending bulk emails can be problemtic for our domain: ardenbeachesinc.com
         - Your IP address(es) or domain(s) may be blacklisted by internet service providers for many reasons: if they see a sudden spike in email volume, complaints from receivers, or sending to bad emails.
       - https://www.mailgun.com/blog/deliverability/email-blasts-dos-donts-mass-email-sending/
       - https://pearllemonleads.com/bulk-emails-top-pitfalls-to-avoid/
  - Accounting
    - Yearly Closeout/Prep
      - Reset Lot Fees Paid?
      - Reset Resident Verification?
        - Deed Holders change validation when property changes ownership
        - Non-deed holders (renters, dependents, borders) need to be revalidated yearly
    - Report with Mailing Address
      - If Deed Holder has multiple properties, the invoices should be sent to mailing address NOT property address
  - Export to CSV

## Deploy

- Staging: https://nameless-eyrie-92885.herokuapp.com/
  - `git push staging main`
  - Staging is the default remote
  - Command example: `heroku run rails db:migrate`
- Production: https://abi-registrar.herokuapp.com/
  - `git push heroku main`
  - Command example: `heroku run -r heroku rails db:migrate`
